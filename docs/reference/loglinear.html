<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a hierarchical log-linear model with algebraic methods — loglinear • algstat</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit a hierarchical log-linear model with algebraic methods — loglinear" />
<meta property="og:description" content="loglinear() fits a hierarchical log-linear model to a dataset (typically a
contingency table) and performs an exact conditional test on the fitted model
using various distance metrics.  The exact test, which is a goodness-of-fit
test, is performed via Monte-Carlo sampling from the conditional distribution
of the table given the sufficient statistics of the model.  In short,
inference is drawn by comparing the statistic of the observed table (be it an
unnormalized log-likelihood, a Pearson chi-squared value, or another metric)
to those of the samples.  The proportion of sampled tables with equal to or
more extreme values than the observed table is the resulting p-value." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">algstat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.904</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a hierarchical log-linear model with algebraic methods</h1>
    
    <div class="hidden name"><code>loglinear.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>loglinear()</code> fits a hierarchical log-linear model to a dataset (typically a
contingency table) and performs an exact conditional test on the fitted model
using various distance metrics.  The exact test, which is a goodness-of-fit
test, is performed via Monte-Carlo sampling from the conditional distribution
of the table given the sufficient statistics of the model.  In short,
inference is drawn by comparing the statistic of the observed table (be it an
unnormalized log-likelihood, a Pearson chi-squared value, or another metric)
to those of the samples.  The proportion of sampled tables with equal to or
more extreme values than the observed table is the resulting p-value.</p>
    </div>

    <pre class="usage"><span class='fu'>loglinear</span>(
  <span class='no'>model</span>,
  <span class='no'>data</span>,
  <span class='kw'>init</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/latte/man/tab2vec.html'>tab2vec</a></span>(<span class='no'>data</span>),
  <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>burn</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>engine</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"C++"</span>, <span class='st'>"R"</span>),
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"ipf"</span>, <span class='st'>"mcmc"</span>),
  <span class='no'>moves</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>hierarchical log-linear model specification</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data, typically as a table but can be in different formats. see
<code><a href='teshape.html'>teshape()</a></code></p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>the initialization of the chain. by default, this is the observed
table</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>number of chain iterations</p></td>
    </tr>
    <tr>
      <th>burn</th>
      <td><p>burn-in</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>thinning</p></td>
    </tr>
    <tr>
      <th>engine</th>
      <td><p><code>"C++"</code> or <code>"R"</code>? (C++ is significantly faster)</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>should the expected value (exp) be fit using iterative
proportional fitting (via loglin) or the MCMC as the average of the steps?</p></td>
    </tr>
    <tr>
      <th>moves</th>
      <td><p>the markov moves for the mcmc (as columns of a matrix).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>...</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list containing named elements</p>
<ul>
<li><p><code>steps</code>: an integer matrix whose columns represent individual
samples from the mcmc.</p></li>
<li><p><code>moves</code>: the moves used for the proposal distribution in the
mcmc, computed with 4ti2 (note that only the positive moves are given).</p></li>
<li><p><code>accept_prob</code>: the empirical transition probability of the
moves, including the thinned moves.</p></li>
<li><p><code>param</code>: the fitted parameters of the log linear model.</p></li>
<li><p><code>df</code>: parameters per term in the model</p></li>
<li><p><code>quality</code>: model selection statistics AIC, AICc, and BIC.</p></li>
<li><p><code>residuals</code>: the (unstandardized) pearson residuals (O - E) /
sqrt(E)</p></li>
<li><p><code>call</code>: the call.</p></li>
<li><p><code>obs</code>: the contingency table given.</p></li>
<li><p><code>exp</code>: the fit contingency table as an integer array.</p></li>
<li><p><code>A</code>: the sufficient statistics computing matrix (from Tmaker).</p></li>
<li><p><code>p.value</code>: the exact p-values of individual tests, accurate to
Monte-Carlo error.  these are computed as the proportion of samples with
statistics equal to or larger than the oberved statistic.</p></li>
<li><p><code>mid.p.value</code>: the mid p.values, see Agresti pp.20--21.</p></li>
<li><p><code>statistic</code>: the pearson's chi-squared (X2), likelihood ratio
(G2), Freeman-Tukey (FT), Cressie-Read (CR), and Neyman modified
chi-squared (NM) statistics computed for the table given.</p></li>
<li><p><code>sampsStats</code>: the statistics computed for each mcmc sample.</p></li>
<li><p><code>cells</code>: the number of cells in the table.</p></li>
<li><p><code>method</code>: the method used to estimate the table.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In many ways, <code>loglinear()</code> is like <code><a href='https://rdrr.io/r/stats/loglin.html'>stats::loglin()</a></code> or <code><a href='https://rdrr.io/pkg/MASS/man/loglm.html'>MASS::loglm()</a></code>;
however, there are a few key differences.</p>
<p>The first difference is methodological.  The tests conducted with
<code>loglinear()</code> are exact conditional tests based on the conditional
distribution of the data given the sufficient statistics for the model.  In
other words, they are analogues of Fisher's exact test for generic log-linear
models.  These tests are made possible by advances in algebraic statistics;
see references 1--3 below.</p>
<p>The second difference between <code>loglinear()</code> and <code><a href='https://rdrr.io/r/stats/loglin.html'>loglin()</a></code> or <code>loglm()</code> is
that inference is made through Monte Carlo simulation. In particular,
<code>loglinear()</code> leverages Markov moves to sample from the conditional
distribution of the data given its sufficent statistics.  If the software
4ti2 is installed on your machine, you can use <code>markov()</code> (or let
<code>loglinear()</code> use <code>markov()</code>) to generate a Markov basis to use for the
Markov moves. This basis is guaranteed to produce a MCMC routine that
converges to the conditional distribution of interest. Since <code>loglinear()</code>
uses Monte Carlo simulation to conduct inference, and since it uses MCMC to
do so, concerns typical to MCMC should be addressed. In particular, issues
such as burn in and mixing (autocorrelation of samples) should be addressed.
The examples illustrate some of these topics.  The result is a p-value that
is generated by Monte Carlo simulation.  Its standard error is provided
(computed as in the standard CLT confidence interval) to give a sense of the
Monte Carlo error.</p>
<p>A third way that <code>loglinear()</code> differs from <code><a href='https://rdrr.io/r/stats/loglin.html'>loglin()</a></code> or <code>loglm()</code> is in
generalizing the kinds of tests performed.  While those allow for asymptotic
unconditional testing using Pearson's X^2 test and the likelihood ratio test,
<code>loglinear()</code> gives several test statistics: Pearson's X^2, the likelihood
ratio G^2, Freeman-Tukey, Cressie-Read (lambda = 2/3), and Neyman's modified
X^2., see the last reference.  In other words, to compute the exact p-value,
iter = 1e4 samples are sampled from the conditional distribution of the table
given the sufficient statistics, and then the proportion of tables that have
X^2, G^2, etc. values greater than or equal to that of the observed table is
the p value for the (conditional) exact test. A similar, and perhaps
preferable approach, simply adds up the probabilities of the tables that have
probabilities less than or equal to that of the observed table; this is the
first line output in hierarchical and does not use a test statistic.</p>
<p>Some authors (see the third reference) suggest that for discrete problems, a
"mid p value" is preferable to the traditional p value, and when presented
should be interepreted in the same way. If the p value is defined to be
P(samps &gt;= obs), the mid p value is defined to be P(samps &gt; obs) + P(samps ==
obs)/2.  The mid p value is computed for each test.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Diaconis, P. and B. Sturmfels (1998). Algebraic Algorithms for
Sampling from Conditional Distributions. <em>The Annals of Statistics</em>
26(1), pp.363-397.</p>
<p>Drton, M., B. Sturmfels, and S. Sullivant (2009). <em>Lectures
on Algebraic Statistics</em>, Basel: Birkhauser Verlag AG.</p>
<p>Aoki, S., H. Hara, and A. Takemura (2012). <em>Markov Bases in
Algebraic Statistics</em>, Springer.</p>
<p>Agresti, A. (2002). <em>Categorical Data Analysis</em>, Basel: John
Wiley &amp; Sons, 2ed.</p>
<p>Agresti, A. (1992). A Survey of Exact Inference for Contingency
Tables <em>Statistical Science</em> 7(1), pp.131-153.</p>
<p>Read, T. and Cressie, N. (1998). <em>Goodness-of-Fit Statistics
for Discrete Multivariate Data</em>, Springer-Verlag.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/loglin.html'>stats::loglin()</a></code>, <code><a href='https://rdrr.io/pkg/MASS/man/loglm.html'>MASS::loglm()</a></code>, <code><a href='metropolis.html'>metropolis()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>David Kahle</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Kahle, Luis Garcia-Puente, Ruriko Yoshida.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


