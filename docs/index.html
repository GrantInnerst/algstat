<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Algebraic Statistics • algstat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Algebraic Statistics">
<meta property="og:description" content="Functions enabling the use of algebraic methods on statistical 
    problems. Prominent application domains are discrete multivariate analysis, 
    discrete and Gaussian graphical models, algebraic pattern recognition, 
    latent variable models, phylogenetics, and more.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">algstat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.904</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="algstat" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#algstat" class="anchor"></a>algstat</h1></div>
<!-- badges: start -->

<p><strong>algstat</strong> is a collection of tools to help you use algebraic statistical methods in R. It is intended to be an end user package for that purpose, and consequently depends on other packages that make connections to math software to do key computations. Currently, <a href="https://github.com/dkahle/latte.git">the <strong>latte</strong> package</a> is used to connect R to <a href="https://www.math.ucdavis.edu/~latte/">LattE</a> with <a href="http://www.4ti2.de">4ti2</a> for lattice problems and the computation of Markov bases, <a href="https://github.com/coneill-math/m2r.git">the <strong>m2r</strong> package</a> connects R to <a href="http://www.math.uiuc.edu/Macaulay2/">Macaulay2</a> for algebraic computations, and <a href="https://github.com/dkahle/bertini">the <strong>bertini</strong> package</a> connects R to <a href="https://bertini.nd.edu">Bertini</a>, which is used to numerically solve systems of polynomial equations. These are at varying stages of development. <strong>m2r</strong> can be used for that purpose to some extent currently by using Macaulay2’s connection to <a href="http://homepages.math.uic.edu/~jan/download.html">PHCPack</a>, so be sure to look there for now if that’s what you’re trying to do.</p>
<p>If you have something you’re wanting implemented here, please file an issue!</p>
</div>
<div id="exact-inference-with-log-linear-models" class="section level1">
<h1 class="hasAnchor">
<a href="#exact-inference-with-log-linear-models" class="anchor"></a>Exact inference with log-linear models</h1>
<p><em>Note: this section assumes you have <a href="https://github.com/dkahle/latte.git"><strong>latte</strong></a> installed and working on your machine.</em></p>
<p>One of the most well-developed parts of the package allows users to perform (conditional) exact tests for log-linear models. There are several great references on the math behind this, such as <a href="http://projecteuclid.org/euclid.aos/1030563990">Diaconis and Sturmfels’ original paper</a>, the <a href="http://smile.amazon.com/Lectures-Algebraic-Statistics-Oberwolfach-Seminars/dp/3764389044/ref=sr_1_1?ie=UTF8&amp;qid=1430536908&amp;sr=8-1&amp;keywords=lectures+on+algebraic+statistics">Lectures on Algebraic Statistics</a>, and <a href="http://smile.amazon.com/Markov-Bases-Algebraic-Statistics-Springer/dp/1461437180/ref=sr_1_fkmr0_1?ie=UTF8&amp;qid=1430536933&amp;sr=8-1-fkmr0&amp;keywords=aoki%2C+hada%2C+and+takemura">Markov Bases in Algebraic Statistics</a>, so we’ll keep the technical discussion to a minimum.</p>
<div id="fishers-exact-test" class="section level3">
<h3 class="hasAnchor">
<a href="#fishers-exact-test" class="anchor"></a>Fisher’s exact test</h3>
<p>We’ll begin by doing Fisher’s exact test on a built-in dataset called politics.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"algstat"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># Loading required package: mpoly</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># Loading required package: latte</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#   Please cite latte! See citation("latte") for details.</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Loading required package: bertini</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#   Please cite bertini! See citation("bertini") for details.</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Loading required package: m2r</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#   Please cite m2r! See citation("m2r") for details.</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#   M2 found in /Applications/Macaulay2-1.10/bin</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Please cite algstat! See citation("algstat") for details.</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(politics)</span>
<span id="cb1-12"><a href="#cb1-12"></a>politics</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#            Party</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co"># Personality Democrat Republican</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#   Introvert        3          7</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#   Extrovert        6          4</span></span></code></pre></div>
<p>Here’s how you typically do Fisher’s exact test in R:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span>(politics)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># </span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#   Fisher's Exact Test for Count Data</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># data:  politics</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co"># p-value = 0.3698</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># 95 percent confidence interval:</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#  0.03005364 2.46429183</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># sample estimates:</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># odds ratio </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#   0.305415</span></span></code></pre></div>
<p>Since the independence model is log-linear, this exact same procedure can be done with <strong>algstat</strong>. The go-to function here is <code><a href="reference/loglinear.html">loglinear()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="reference/loglinear.html">loglinear</a></span>(<span class="op">~</span><span class="st"> </span>Personality <span class="op">+</span><span class="st"> </span>Party, <span class="dt">data =</span> politics)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># Computing Markov moves (4ti2)... done.</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># Running chain (C++)... done.</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># Call:</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># loglinear(model = ~Personality + Party, data = politics)</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># </span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># Fitting method:</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co"># Iterative proportional fitting (with stats::loglin)</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># </span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># MCMC details:</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co"># N = 10000 samples (after thinning), burn in = 1000, thinning = 10</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co"># </span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#                  stat p.value     se mid.p.value</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#       P(table)         0.3713 0.0048      0.2185</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#    Pearson X^2 1.8182  0.3713 0.0048      0.2185</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co"># Likelihood G^2 1.848   0.3713 0.0048      0.2185</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#  Freeman-Tukey 1.8749  0.3713 0.0048      0.2185</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#   Cressie-Read 1.8247  0.3713 0.0048      0.2185</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#     Neyman X^2 2.0089  0.3713 0.0048      0.2951</span></span></code></pre></div>
<p>Exact inference in algebraic statistics is done using MCMC to sample from the conditional distribution of the data given its sufficient statistics under the model. Consequently, the p-values estimated are only determined up to Monte Carlo error. The standard p-value is given under the column <code>p.value</code> in the row labeled <code>P(samp)</code>.</p>
<p>The asymptotic test of independence analogous to Fisher’s exact test (which does not condition on the marginals being known) can be done in either of two ways.</p>
<p>The first way uses the <code><a href="https://rdrr.io/r/stats/loglin.html">loglin()</a></code> function from the <strong>stats</strong> package. It outputs the likelihood ratio statistic (<code>Likelihood G^2</code> in the output above) and Pearson’s chi-squared statistic (<code>Pearson X^2</code> above), but you have to calculate the p-value yourself.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>(loglinMod &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/loglin.html">loglin</a></span>(politics, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># 2 iterations: deviation 0</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># $lrt</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># [1] 1.848033</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># </span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># $pearson</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># [1] 1.818182</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># $df</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># [1] 1</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># </span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># $margin</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># $margin[[1]]</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co"># [1] "Personality"</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co"># </span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co"># $margin[[2]]</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co"># [1] "Party"</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="kw"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span>(loglinMod<span class="op">$</span>pearson, <span class="dt">df =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co"># [1] 0.1775299</span></span></code></pre></div>
<p>The second way is the <code>loglm()</code> function in the <strong>MASS</strong> package, which is a nice wrapper of <code><a href="https://rdrr.io/r/stats/loglin.html">loglin()</a></code> (in fact, <strong>algstat</strong>’s <code><a href="reference/loglinear.html">loglinear()</a></code> function uses the IPF implementation from <code><a href="https://rdrr.io/r/stats/loglin.html">loglin()</a></code>, although it doesn’t need to). It’s syntax looks identical to <code><a href="reference/loglinear.html">loglinear()</a></code>’s above:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/loglm.html">loglm</a></span>(<span class="op">~</span><span class="st"> </span>Personality <span class="op">+</span><span class="st"> </span>Party, <span class="dt">data =</span> politics)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Call:</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># MASS::loglm(formula = ~Personality + Party, data = politics)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Statistics:</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#                       X^2 df  P(&gt; X^2)</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co"># Likelihood Ratio 1.848033  1 0.1740123</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co"># Pearson          1.818182  1 0.1775299</span></span></code></pre></div>
</div>
<div id="fishers-exact-test-on-rxc-tables" class="section level3">
<h3 class="hasAnchor">
<a href="#fishers-exact-test-on-rxc-tables" class="anchor"></a>Fisher’s exact test on RxC tables</h3>
<p>Doing Fisher’s exact test on larger problems is a significantly more complicated problem. The documentation for <code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code> illustrates how it can be used on RxC tables in general, not just on 2x2 tables. Here’s an example from its documentation drawn from Agresti (2002, p.57):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>Job &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">1</span>, <span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">14</span>,<span class="dv">9</span>, <span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">11</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="dt">dimnames =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="st">"income"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"&lt; 15k"</span>, <span class="st">"15-25k"</span>, <span class="st">"25-40k"</span>, <span class="st">"&gt; 40k"</span>),</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="st">"satisfaction"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"VeryD"</span>, <span class="st">"LittleD"</span>, <span class="st">"ModerateS"</span>, <span class="st">"VeryS"</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a>  )</span>
<span id="cb6-7"><a href="#cb6-7"></a>)</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a>Job</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#         satisfaction</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># income   VeryD LittleD ModerateS VeryS</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#   &lt; 15k      1       3        10     6</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#   15-25k     2       3        10     7</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#   25-40k     1       6        14    12</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#   &gt; 40k      0       1         9    11</span></span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="kw"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span>(Job)</span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co"># </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#   Fisher's Exact Test for Count Data</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co"># </span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co"># data:  Job</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co"># p-value = 0.7827</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co"># alternative hypothesis: two.sided</span></span></code></pre></div>
<p>Here’s the <strong>algstat</strong> counterpart:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="reference/loglinear.html">loglinear</a></span>(<span class="op">~</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>satisfaction, <span class="dt">data =</span> Job)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># Care ought be taken with tables with sampling zeros to ensure the MLE exists.</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># Computing Markov moves (4ti2)... done.</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Running chain (C++)... done.</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># Call:</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># loglinear(model = ~income + satisfaction, data = Job)</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># </span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co"># Fitting method:</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co"># Iterative proportional fitting (with stats::loglin)</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># </span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co"># MCMC details:</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co"># N = 10000 samples (after thinning), burn in = 1000, thinning = 10</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># </span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#                  stat p.value     se mid.p.value</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#       P(table)         0.7855 0.0041      0.785 </span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#    Pearson X^2 5.9655  0.7722 0.0042      0.7722</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co"># Likelihood G^2 6.7641  0.7761 0.0042      0.7761</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#  Freeman-Tukey 8.6189  0.7768 0.0042      0.7768</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#   Cressie-Read 6.0752  0.7735 0.0042      0.7735</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#     Neyman X^2 6.2442  0.6057 0.0049      0.6057</span></span></code></pre></div>
<p>The asymptotic test can be performed as well. The chi-square approximation is actually very good here:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/loglm.html">loglm</a></span>(<span class="op">~</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>satisfaction, <span class="dt">data =</span> Job)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># Call:</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># MASS::loglm(formula = ~income + satisfaction, data = Job)</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># Statistics:</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#                       X^2 df  P(&gt; X^2)</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># Likelihood Ratio 6.764053  9 0.6616696</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># Pearson          5.965515  9 0.7433647</span></span></code></pre></div>
</div>
<div id="fishers-exact-test-on-multi-way-tables" class="section level3">
<h3 class="hasAnchor">
<a href="#fishers-exact-test-on-multi-way-tables" class="anchor"></a>Fisher’s exact test on multi-way tables</h3>
<p><code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code> does not work with multi-way tables and is prone to crashing even in large-celled two-way tables (see <code><a href="reference/loglinear.html">?loglinear</a></code> for an example). Thus, the only way to do exact inference in multi-way tables is to use <code><a href="reference/loglinear.html">loglinear()</a></code>. We’ll illustrate this using the drugs dataset from <code><a href="reference/loglinear.html">loglinear()</a></code>’s documentation, taken from Agresti (2002, p.322), on which we’ll test the no-three-way interaction model:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(drugs)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw"><a href="https://rdrr.io/r/stats/ftable.html">ftable</a></span>(drugs)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#                     Alcohol Yes  No</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Cigarette Marijuana                </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Yes       Yes               991   3</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#           No                538  43</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># No        Yes                44   2</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#           No                456 279</span></span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="kw"><a href="reference/loglinear.html">loglinear</a></span>(<span class="kw"><a href="reference/subsets.html">subsets</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">2</span>), <span class="dt">data =</span> drugs)</span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># Computing Markov moves (4ti2)... done.</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co"># Running chain (C++)... done.</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co"># Call:</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># loglinear(model = subsets(1:3, 2), data = drugs)</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co"># </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># Fitting method:</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co"># Iterative proportional fitting (with stats::loglin)</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co"># </span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co"># MCMC details:</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co"># N = 10000 samples (after thinning), burn in = 1000, thinning = 10</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co"># </span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#                  stat p.value     se mid.p.value</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#       P(table)         0.6016 0.0049      0.4598</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#    Pearson X^2 0.5279  0.6016 0.0049      0.4598</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co"># Likelihood G^2 0.4845  0.6016 0.0049      0.4598</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#  Freeman-Tukey 0.4672  0.6016 0.0049      0.4598</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#   Cressie-Read 0.512   0.6016 0.0049      0.4598</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">#     Neyman X^2 0.4294  0.6016 0.0049      0.4598</span></span></code></pre></div>
<p>Note that here we’ve used the more concise syntax of facet specification; if you want to understand the model specification better, read the documentation in <code><a href="reference/loglinear.html">?loglinear</a></code>. You can perform the asymptotic test with <code>loglm()</code> like this:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/loglm.html">loglm</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">1</span><span class="op">*</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">*</span><span class="dv">3</span>, <span class="dt">data =</span> drugs)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># Call:</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># MASS::loglm(formula = ~1 * 2 + 2 * 3 + 1 * 3, data = drugs)</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># </span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co"># Statistics:</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#                        X^2 df  P(&gt; X^2)</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co"># Likelihood Ratio 0.4845145  1 0.4863845</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co"># Pearson          0.5279994  1 0.4674492</span></span></code></pre></div>
</div>
</div>
<div id="other-statistical-applications-of-latte-and-4ti2" class="section level1">
<h1 class="hasAnchor">
<a href="#other-statistical-applications-of-latte-and-4ti2" class="anchor"></a>Other statistical applications of LattE and 4ti2</h1>
<p><em>Note: this section assumes you have <a href="https://github.com/dkahle/latte.git"><strong>latte</strong></a> installed and working on your machine.</em></p>
<p>Most <a href="https://www.math.ucdavis.edu/~latte/">LattE</a> programs are available as functions in <strong>latte</strong>, which is imported by <strong>algstat</strong>. Checkout the readme for <strong>latte</strong> <a href="https://github.com/dkahle/latte">here</a>.</p>
<p>There are many statistical applications and potential applications of LattE in R. One example is found in the <code>count</code> program, implemented in <code><a href="https://rdrr.io/pkg/latte/man/latte-count.html">latte::latte_count()</a></code>. <code><a href="https://rdrr.io/pkg/latte/man/latte-count.html">latte::latte_count()</a></code> counts the number of integer points in a <a href="https://en.wikipedia.org/wiki/Convex_polytope">convex polytope</a>. This can be useful for counting the number of contingency tables with fixed marginals. <strong>algstat</strong> uses <code><a href="https://rdrr.io/pkg/latte/man/latte-count.html">latte::latte_count()</a></code> in the <code><a href="reference/count-tables.html">count_tables()</a></code> function, which determines the number of contingency tables in the <a href="http://en.wikipedia.org/wiki/Fiber_(mathematics)">fiber (isostatistical region)</a> of a table given an <a href="http://en.wikipedia.org/wiki/Exponential_family">exponential family model</a>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="reference/count-tables.html">count_tables</a></span>(politics) <span class="co"># the independence model is the default</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># [1] 10</span></span></code></pre></div>
<p>For example, we can determine the number of tables with the same row sums of <code>politics</code> as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>(A &lt;-<span class="st"> </span><span class="kw"><a href="reference/hmat.html">hmat</a></span>(<span class="dt">varlvls =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">facets =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,])</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#    11 12 21 22</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># 1+  1  1  0  0</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># 2+  0  0  1  1</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw"><a href="reference/count-tables.html">count_tables</a></span>(politics, A)</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co"># [1] 121</span></span></code></pre></div>
</div>
<div id="numerically-solving-systems-of-polynomial-equations" class="section level1">
<h1 class="hasAnchor">
<a href="#numerically-solving-systems-of-polynomial-equations" class="anchor"></a>Numerically solving systems of polynomial equations</h1>
<p><em>Note: this section assumes you have <a href="https://bertini.nd.edu">Bertini</a> installed and algstat has registered it.</em></p>
<p><strong>algstat</strong> also provides back-end connections to <a href="https://bertini.nd.edu">Bertini</a> to solve systems of polynomial equations. While this work is still being implemented, here’s a peak at what it can currently do.</p>
<p>First, <strong>algstat</strong> can run raw Bertini programs using <code>bertini()</code>. It also has a nice print method to display the results. For example, here’s how you would find the intersection of the line f(x) = x and the unit circle using Bertini:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>code &lt;-<span class="st"> "</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">INPUT</span></span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="st">variable_group x, y;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st">function f, g;</span></span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="st">f = x^2 + y^2 - 1;</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="st">g = y - x;</span></span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="st">END;</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="st">"</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="kw">bertini</span>(code)</span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co"># 2 solutions (x,y) found. (2 real, 0 complex)</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#     (-0.707,-0.707) (R)</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#     ( 0.707, 0.707) (R)</span></span></code></pre></div>
<p>Even better, <strong>algstat</strong> can team up with <a href="http://github.com/dkahle/mpoly"><strong>mpoly</strong></a> (working under the hood) to solve systems of polynomial equations using <code>poly_solve()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>); <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>())</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># Attaching package: 'ggplot2'</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># The following object is masked from 'package:mpoly':</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#     vars</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="kw"><a href="reference/ggvariety.html">ggvariety</a></span>(<span class="kw">mp</span>(<span class="st">"(y - x^2) (y - (2 - x^2))"</span>), <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">n =</span> <span class="dv">351</span>)</span></code></pre></div>
<p><img src="tools/poly-solve-1.png"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">poly_solve</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y = x^2"</span>, <span class="st">"y = 2 - x^2"</span>), <span class="dt">varorder =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># 2 solutions (x,y) found. (2 real, 0 complex)</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#     (-1,1) (R)</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#     ( 1,1) (R)</span></span></code></pre></div>
</div>
<div id="variety-normal-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#variety-normal-distribution" class="anchor"></a>Variety normal distribution</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="st">"mc.cores"</span> =<span class="st"> </span>parallel<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span>())</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a>p &lt;-<span class="st"> </span><span class="kw">mp</span>(<span class="st">"(x^2 + y^2 - 1)^3 - x^2 y^3"</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>(samps &lt;-<span class="st"> </span><span class="kw"><a href="reference/rvnorm.html">rvnorm</a></span>(<span class="dv">500</span>, p, <span class="fl">.025</span>, <span class="st">"tibble"</span>, <span class="dt">chains =</span> <span class="dv">8</span>))</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># # A tibble: 4,000 x 8</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#        x      y      num denom        ng  lp__ chain  iter</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#  1 0.981  1.07   0.162   6.50   0.0249    2.27     1   251</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#  2 0.979  1.06   0.137   6.29   0.0217    2.39     1   252</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#  3 0.895 -0.197  0.00207 0.195  0.0106    2.68     1   253</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#  4 1.10   0.222  0.00226 0.393  0.00575   2.74     1   254</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#  5 1.13   0.216  0.0209  0.687  0.0304    2.03     1   255</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#  6 1.11   0.205  0.0110  0.502  0.0218    2.39     1   256</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#  7 0.757  1.17  -0.0928  4.10  -0.0226    2.36     1   257</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#  8 0.765  1.19   0.0357  5.24   0.00681   2.73     1   258</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#  9 0.742  1.20   0.00398 4.88   0.000815  2.77     1   259</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co"># 10 1.08   0.842 -0.0151  4.02  -0.00376   2.76     1   260</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co"># # … with 3,990 more rows</span></span>
<span id="cb16-19"><a href="#cb16-19"></a></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(samps, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span>()</span></code></pre></div>
<p><img src="tools/rvnorm-1.png"></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(samps, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y, <span class="dt">color =</span> iter)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(chain), <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="tools/rvnorm-2.png"></p>
<p>For semi-algebraic sets:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>p &lt;-<span class="st"> </span><span class="kw">mp</span>(<span class="st">"(x^2 + y^2 - 1)^3 - x^2 y^3 + s^2"</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>samps &lt;-<span class="st"> </span><span class="kw"><a href="reference/rvnorm.html">rvnorm</a></span>(<span class="dv">500</span>, p, <span class="fl">.025</span>, <span class="st">"tibble"</span>, <span class="dt">chains =</span> <span class="dv">8</span>) </span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(samps, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span>()</span></code></pre></div>
<p><img src="tools/rvnorm-semi-alg-1.png"></p>
<p>After being migrated onto the variety or semi-algebraic set, these can be used as a mesh on that geometry. Here’s a cool image made using <a href="https://github.com/thomasp85/ggforce"><strong>ggforce</strong></a>’s <code><a href="https://ggforce.data-imaginist.com/reference/geom_delvor.html">geom_voronoi_segment()</a></code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggforce"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(samps, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x, y)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggforce.data-imaginist.com/reference/geom_delvor.html">geom_voronoi_segment</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span>()</span></code></pre></div>
<p><img src="tools/mesh-1.png"></p>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>This material is based upon work supported by the National Science Foundation under Grant Nos. <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1622449">1622449</a> and <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1622369">1622369</a>.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<div id="installing-algstat" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-algstat" class="anchor"></a>Installing algstat</h2>
<p>There are currently two ways to get <strong>algstat</strong>. Here’s the preferred way until we push a new release to CRAN:</p>
<ul>
<li>From Github:</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"devtools"</span>)) <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"dkahle/mpoly"</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"coneill-math/m2r"</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"dkahle/latte"</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"dkahle/bertini"</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"dkahle/algstat"</span>)</span></code></pre></div>
<ul>
<li>From CRAN: <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("algstat")</a></code> (don’t get this now; it’s currently out of date)</li>
</ul>
</div>
<div id="installing-supporting-software" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-supporting-software" class="anchor"></a>Installing supporting software</h2>
<p>Coming soon! See the links above for direct information.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=algstat">https://​cloud.r-project.org/​package=algstat</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing algstat</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>David Kahle <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9999-1558" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>Luis Garcia-Puente <br><small class="roles"> Author </small>  </li>
<li>Ruriko Yoshida <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=algstat"><img src="https://www.r-pkg.org/badges/version/algstat" alt="CRAN status"></a></li>
<li><a href="https://travis-ci.org/dkahle/algstat"><img src="https://travis-ci.org/dkahle/algstat.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/dkahle/algstat"><img src="https://ci.appveyor.com/api/projects/status/github/dkahle/algstat?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by David Kahle, Luis Garcia-Puente, Ruriko Yoshida.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
